# **COMIGHT助手使用说明**

## **系统要求和使用方法**

需要Windows 10及以上版本，MS Office 2016及以上版本或Microsoft 365。将全部文件解压到同一文件夹，双击COMIGHT.EXE即可运行。如系统提示安装.NET Framework框架，按照提示安装。

运行程序后，在主窗口上方的菜单内选择功能选项，根据界面提示，在文件或文件夹选择对话框中选择需要处理的文件或文件夹，并按提示输入相关参数即可。生成的文件和文件夹均位于源文件所在文件夹内。

## **功能介绍**

### **文档处理**

**1.结构化文档表导出为Word/PPT**

将结构化文档表的内容导出为Word文档，各级标题自动编号，并按国家机关公文格式排版。同时，可以选择同步生成一份纯文本PPT汇报稿。

结构化文档表的“大标题首尾”和“主体”工作表内容可按需要填写修改；“标题级别”应使用下拉框选择输入，格式为“0级”、“1级”、“2级”、“3级”、“4级”、“是”、“条”，依次对应编号“第一部分、第二部分、第三部分...”、“一、二、三、...”、“（一）（二）（三）...”、“1. 2. 3. ...”、“（1）（2）（3）...”、“一是 二是 三是”、“第一条 第二条 第三条 ...”。如选择“接上段”，则此行对应的文字将与上一段紧接，当中不分段。

结构化文档表填写说明：

结构化文档表模板随本程序提供，内有填写提示，按实际需要修改即可。第1张工作表为“小标题”工作表，第2和第3张工作表分别为“大标题首尾”工作表和“主体”工作表。其中，第2张工作表的“文字”列，第3张工作表的“标题级别”列、“文字”列为必填，作为输出文档的内容来源；其余列为选填，用于备注、筛选等。3张工作表均不可删除、不可移动位置、不可改变列结构，否则会导致程序运行或输出结果异常。凡被隐藏或筛选掉的行，将不会被导出。

**2.Word文档导入结构化文档表**

与以上功能相反，将Word文件内容导入结构化文档表。

**3.文本框文字导入结构化文档表**

将主界面“可导出文字”文本框的内容导入结构化文档表，存放于Windows桌面上。

**4.提取Word文档内容至结构化文档表**

根据“小标题”工作表中的小标题，从Word文档中提取与小标题相关的文字。

**5.批量调整Word文档格式**

原文件格式要求：大标题位于文首，总字数不超过60字（同一文档中如有多篇文章，每篇须新起一页，与前一篇以分页符或分节符隔开）。正文与大标题至少空开一行，每个小标题不超过40字。一级标题序号为中文小写数字加顿号：“一、 二、 三、”；二级标题序号为中文小写数字加小括号：“（一） （二） （三）”；三级标题序号为阿拉伯数字加实心圆点（英文句号）：“1. 2. 3.”；四级标题序号为阿拉伯数字加小括号：“（1） （2） （3）”。落款与正文至少空开一行，上方为单位、部门（可有多个，上下排列），最后一行为日期（XXXX年XX月XX日）。分栏、含复杂表格以及图文混排的文档不适用。

### **表格处理**

**1.批量调整Excel工作簿**

* 调整Excel工作表打印版式：**根据工作表上每一列的内容，自动调整合适列宽，同时调整字体大小、自动换行等，并根据表格内容多少合理设置页面布局。

* 撤销Excel工作表隐藏状态：**如果在批处理工作簿时，遇到“有隐藏工作表”的提示，可使用本功能将所有工作簿中隐藏的工作表恢复可见，然后重新确定工作表序号。

**2.批处理Excel工作簿**

* 记录合并：**将表头相同的多个工作簿的记录进行纵向合并，形成总表。

应用举例：有人员名册若干份，表头相同，汇总后形成一份人员总名册。

* 数值累加：**将多个工作簿内指定区域单元格的数值进行分别累加，形成汇总表。

应用举例：有统计表若干，对所有统计表的B2到C3区域（包含B2、B3、C2、C3等4个单元格）的数据进行汇总统计，形成一张合计表，该合计表B2单元格的数值等于每张统计表B2单元格数值之和，B3单元格的数值等于每张统计表B3单元格数值之和，C2单元格的数值等于每张统计表C2单元格数值之和，C3单元格的数值等于每张统计表C3单元格数值之和。

* 提取单元格数据：**提取多个工作簿内指定区域单元格的数据，形成汇总表。

应用举例：有统计表若干，对所有统计表的B2到C3区域（包含B2、B3、C2、C3 4个单元格）的数据进行提取，形成一张提取汇总表，该提取汇总表的每一行分别对应一张统计表，从左到右依次列出每张统计表的文件名、工作表名及其B2、B3、C2、C3单元格的数据。

* 文本型数字转数值型：**将多工作簿指定区域单元格内的文本型数字转为数值型数字。

应用举例：有统计表若干，其中B2到C3区域（包含B2、B3、C2、C3等4个单元格）的个别数据为文本格式，如果直接进行求和等计算，文本格式的单元格可能会被当作0值处理，造成计算结果不正确。使用本功能将B2到C3区域单元格的文本型数字全都转换为数值型数字，同时生成一张“数值转换错误”表，详细列出未能成功转换的单元格所在的工作簿、工作表、位置和值。

* 复制公式到多工作簿：**将模板工作簿内指定区域单元格的公式复制粘贴到多个目标工作簿。待复制公式须存放在模板工作簿的第一张工作表中。

应用举例：有一份模板表格，其中的E2单元格含有求和公式“=SUM(A2:D2)”，E3单元格含有求和公式“=SUM(A3:D3)”，E4单元格含有求和公式“=SUM(A4:D4)”。将该模板表格的E2:E4区域复制并粘贴到多个目标表格，使所有目标表格的E2单元格都含有求和公式“=SUM(A2:D2)”，E3单元格都含有求和公式“=SUM(A3:D3)”，E4单元格都含有求和公式“=SUM(A4:D4)”。

* 提取单元格数据给文件名加前缀：**提取多个工作簿指定区域单元格的数据，作为前缀添加于相应工作簿原文件名之前，进行重命名。

应用举例：有部门名册若干，文件名分别为“名册1.xlsx”、“名册2.xlsx”、“名册3.xlsx”、“名册4.xlsx”，每个名册的A1、A2单元格分别标明了该名册所属部门和更新时间，如名册1.xlsx的A1、A2单元格分别为“市场部”、“2023年8月”，名册2.xlsx的A1、A2单元格分别为“研发部”、“2023年9月”，名册3.xlsx的A1、A2单元格分别为“财务部”、“2023年10月”，名册4.xlsx的A1、A2单元格分别为“人事部”、“2023年11月”。使用本功能提取每个名册的A1、A2单元格作为前缀添加在文件名之前，则原名册的文件名被重命名为：“市场部 2023年8月\_名册1.xlsx”、“研发部 2023年9月\_名册2.xlsx”、“财务部 2023年10月\_名册3.xlsx”、“人事部 2023年11月\_名册4.xlsx”。

**3.拆分Excel工作表**

* 拆分为工作簿：**按工作表指定列数据的同异，对表格进行拆分，生成独立的工作簿。被拆分的数据须存放于第一张工作表内。

应用举例：有一份学生名册，其中B列为班级（1班、2班、3班），按B列拆分后，1、2、3班的学生各自生成一张名册，存放于不同的工作簿内。

* 拆分为工作表：**功能同上，只是拆分后的表格存放在一个工作簿的不同工作表内，工作表名称为拆分列的数据。工作表数量不能超过255个，否则会报错。

**4.比较Excel工作表**

将起始数据工作表和终点数据工作表中主键值和列字段相同的数据进行比对，并列出前后差异（如果为数值型数据，同时计算变化率百分比）。起始数据工作表和终点数据工作表须存放于两个不同的工作簿中，且均为第一张工作表；记录应确保唯一性（即不存在主键值相同的多条记录）。

**5.筛选股票**

根据股票市净率、市盈率数据，筛选估值低、具有安全边际的股票。股票数据Excel工作簿文件可从证券分析软件中导出。数据须存放于第一张工作表内，表头只能有一行，且必须含有股票代码、名称、所属行业、现价、市盈率、市净率等6个列字段名。筛选结果将存放于第二张工作表内。

### **文件工具**

**1.批量转换Office文件类型**

将旧版Excel表格（.xls）、Word（.doc）文档，WPS表格（.et）、WPS文档（.wps）批量转换为目前通用的.xlsx、.docx格式。

**2.合并文档和表格**

将选定的Word文档和Excel表格先转换为无格式的纯文本，然后合并至一个Word文档中。主要用于向AI聊天对话框中输入语料。

**3.生成文件列表**

将指定文件夹路径中所有的子文件夹名、文件名形成列表。

**4.创建文件夹**

根据“创建文件夹”Excel工作簿中的文件夹结构数据，批量创建文件夹。文件夹从左往右逐级建立，越往左侧的文件夹级别越高（越靠近根目录），越往右侧的文件夹级别越低（越远离根目录）。数据须存放于第一张工作表内。

**5.创建座位牌**

根据名册Excel工作簿中的数据，批量创建座位牌（20 x 10cm规格）。座位牌上的姓名、单位须存放于第一张工作表的A列（可以分上下两行），从A1单元格开始依次向下。每个座位牌最多可容纳10个字，如果超过限制，将无法完整打印。

### **浏览器**

本浏览器能直接整段复制大部分网页上的文字内容，而不必使用鼠标拖动+SHIFT键配合选定再复制等操作。复制的文字不含HTML标记、图片等，粘贴至Word后不会影响格式和排版。

使用时，将鼠标指针移动到文字上，当文字块四周出现淡绿色外框时，双击鼠标，此时文字被全选，同时外框短暂变为粉红色，表示文字已经被复制。如遇到个别网页在双击鼠标后文字未被成功复制，按Ctrl+C快捷键即可。

程序所在文件夹中有Database.xlsx文件，内含的网址在浏览器启动时会自动加载至常用网址下拉框。用户可按需对此文件进行编辑修改（网址列表只能放在"Websites"，且表头不能改动）。

### **设置**

用于设置Pandoc程序。在弹出的对话框中输入Pandoc程序文件路径即可。



开发者：Yuechen Lou

2024年3月30日
