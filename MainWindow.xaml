<Window x:Class="COMIGHT.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        mc:Ignorable="d"
        Title="COMIGHT Assistant 365" Style="{StaticResource BaseWindowStyle}" Width="400" SizeToContent="Height" ResizeMode="CanMinimize" Loaded="MainWindow_Loaded" Closing="MainWindow_Closing"   >

    <Grid>

        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <DockPanel Grid.Row="0" >

            <Menu DockPanel.Dock="Top" Height="30" FontSize="{Binding Path=FontSize, RelativeSource={RelativeSource FindAncestor, AncestorType=Window}}" UseLayoutRounding="True" VerticalContentAlignment="Center" >

                <Menu.Resources>
                    <Style TargetType="MenuItem">
                        <Style.Triggers>
                            
                            <EventTrigger RoutedEvent="MenuItem.MouseEnter">
                                <BeginStoryboard>
                                    <Storyboard  BeginTime="0:0:0.3">
                                        <BooleanAnimationUsingKeyFrames Storyboard.TargetProperty="IsSubmenuOpen">
                                            <DiscreteBooleanKeyFrame KeyTime="0" Value="True"/>
                                        </BooleanAnimationUsingKeyFrames>
                                    </Storyboard>
                                </BeginStoryboard>
                            </EventTrigger>
                            
                            <EventTrigger RoutedEvent="MenuItem.MouseLeave">
                                <BeginStoryboard>
                                    <Storyboard  BeginTime="0:0:0.2">
                                        <BooleanAnimationUsingKeyFrames Storyboard.TargetProperty="IsSubmenuOpen">
                                            <DiscreteBooleanKeyFrame KeyTime="0" Value="False"/>
                                        </BooleanAnimationUsingKeyFrames>
                                    </Storyboard>
                                </BeginStoryboard>
                            </EventTrigger>
                            
                        </Style.Triggers>
                    </Style>
                </Menu.Resources>

                <MenuItem Header="Start">
                    <MenuItem Header="Open Saving Folder" Click="MnuOpenSavingFolder_Click" />
                    <MenuItem Header="Settings" Click="MnuSettings_Click"  />
                    <MenuItem Header="Help" Click="MnuHelp_Click" />
                    <MenuItem Header="Exit" Click="MnuExit_Click" />
                    <!-- <MenuItem Header="Test" Click="MnuTest_Click" /> -->
                </MenuItem>

                <MenuItem Header="Table">
                    <MenuItem Header= "Batch Process Excel Worksheets" Click="MnuBatchProcessExcelWorksheets_Click" />
                    <MenuItem Header= "Batch Disassemble Excel Workbooks" Click="MnuBatchDisassembleExcelWorkbooks_Click" />
                    <MenuItem Header= "Batch Unhide Excel Worksheets" Click="MnuBatchUnhideExcelWorksheets_Click" />
                    <MenuItem Header= "Batch Extract Tables From Word" Click="MnuBatchExtractTablesFromWord_Click" />
                    <MenuItem Header= "Create File List" Click="MnuCreateFileList_Click" />
                </MenuItem>

                <MenuItem Header="Document">
                    <MenuItem Header="Convert Markdown Into Word Document" Click="MnuConvertMarkdownIntoWordDocument_Click"  />
                    <MenuItem Header= "Merge Data into Document" Click="MnuMergeDataIntoDocument_Click"  />
                    <MenuItem Header="Batch Format Word Documents" Click="MnuBatchFormatWordDocuments_Click" />
                    <MenuItem Header="Batch Repair Word Documents" Click="MnuBatchRepairWordDocuments_Click"  />
                </MenuItem>

                <MenuItem Header="Tools">
                    <MenuItem Header= "Batch Convert Office Files" Click="MnuBatchConvertOfficeFiles_Click" />
                    <MenuItem Header= "Batch Create Folders" Click="MnuBatchCreateFolders_Click" />
                    <MenuItem Header= "Batch Create Place Cards" Click="MnuBatchCreatePlaceCards_Click" />
                    <MenuItem Header="Remove Markdown Marks In Copied Text" Click="MnuRemoveMarkdownMarksInCopiedText_Click" />
                    <MenuItem Header="Generate QR Code" Click="MnuGenerateQRCode_Click" />
                </MenuItem>

                <!-- <MenuItem Header="Web">
                    <MenuItem Header="Browser" Click="MnuBrowser_Click" />
                </MenuItem> -->
            </Menu>
            
        </DockPanel>

        <StackPanel Grid.Row="1" Margin ="5" Orientation="Vertical">
            <Label x:Name="lblStatus" Height="30" Content ="{Binding Path=StatusText, Mode=Default}"/>
            <Label x:Name="lblIntro" Height="30"/>
        </StackPanel>
        
    </Grid>

</Window>